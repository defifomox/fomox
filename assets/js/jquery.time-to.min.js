/**
 * Time-To jQuery plug-in
 * Show countdown timer or realtime clock
 *
 * @author Oleksii Teterin <altmoc@gmail.com>
 * @version 1.3.0
 * @license MIT http://opensource.org/licenses/MIT
 * @date 2019-05-14
 * @host https://github.com/Lexxus/jq-timeTo
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?module.exports=n(require("jquery")):n(jQuery)})(function(n){function e(n,i){var u=this.data(),p=this.find("ul"),w=!1,o,e,h,c,l,a,s,v,y;if(u.vals&&p.length!==0){for(n||(n=u.seconds),u.intervalId&&(w=!0,clearTimeout(u.intervalId)),o=Math.floor(n/t),e=o*t,h=Math.floor((n-e)/f),e+=h*f,c=Math.floor((n-e)/60),e+=c*60,l=n-e,a=(o<100?"0"+(o<10?"0":""):"")+o+(h<10?"0":"")+h+(c<10?"0":"")+c+(l<10?"0":"")+l,s=u.vals.length-1,v=a.length-1;s>=0;s-=1,v-=1)y=parseInt(a.substr(v,1),10),u.vals[s]=y,p.eq(s).children().html(y);(w||i)&&(u.ttStartTime=Date.now(),u.intervalId=setTimeout(r.bind(this),1e3),this.data("intervalId",u.intervalId))}}function r(t){var c=this,e=this.find("ul"),i=this.data(),u,f,o,s,h,l;if(!i.vals||e.length===0){i.intervalId&&(clearTimeout(i.intervalId),this.data("intervalId",null));i.callback&&i.callback();return}typeof t=="undefined"&&(t=i.iSec);this.data("tickCount",i.tickCount+1);u=i.vals[t];f=e.eq(t);o=f.children();s=i.countdown?-1:1;o.eq(1).html(u);u+=s;typeof i.step=="function"&&i.tickCount%i.stepCount==0&&(this.data("tickCount",0),i.step());t===i.iSec&&(h=i.tickTimeout,l=Date.now()-i.ttStartTime,i.sec+=s,h+=Math.abs(i.seconds-i.sec)*h-l,i.intervalId=setTimeout(r.bind(this),h));u<0||u>i.limits[t]?(u<0?(u=i.limits[t],t===i.iHour&&i.displayDays>0&&i.vals[t-1]===0&&(u=3)):u=0,t>0&&r.call(this,t-1)):!i.countdown&&t===i.iHour&&i.displayDays>0&&i.vals[t-1]===2&&i.vals[t]===3&&(u=0,r.call(this,t-1));o.eq(0).html(u);n.support.transition?(f.addClass("transition"),f.css({top:0}),setTimeout(function(){(f.removeClass("transition"),o.eq(1).html(u),f.css({top:"-"+i.height+"px"}),s>0||t!==i.iSec)||(i.sec<=10&&console.log(i.sec),i.sec===i.countdownAlertLimit&&e.parent().addClass("timeTo-alert"),i.sec<=0&&(e.parent().removeClass("timeTo-alert"),i.intervalId&&(clearTimeout(i.intervalId),c.data("intervalId",null)),typeof i.callback=="function"&&i.callback()))},410)):f.stop().animate({top:0},400,t!==i.iSec?null:function(){(o.eq(1).html(u),f.css({top:"-"+i.height+"px"}),s>0||t!==i.iSec)||(i.sec===i.countdownAlertLimit?e.parent().addClass("timeTo-alert"):i.sec===0&&(e.parent().removeClass("timeTo-alert"),i.intervalId&&(clearTimeout(i.intervalId),c.data("intervalId",null)),typeof i.callback=="function"&&i.callback()))});i.vals[t]=u}var t=86400,f=3600,i={callback:null,step:null,stepCount:1,captionSize:0,countdown:!0,countdownAlertLimit:10,displayCaptions:!1,displayDays:0,displayHours:!0,fontFamily:"Verdana, sans-serif",fontSize:0,lang:"en",languages:{},seconds:0,start:!0,theme:"white",width:25,height:30,gap:11,vals:[0,0,0,0,0,0,0,0,0],limits:[9,9,9,2,9,5,9,5,9],iSec:8,iHour:4,tickTimeout:1e3,intervalId:null,tickCount:0},u={start:function(t){var i;t&&(e.call(this,t),i=setTimeout(r.bind(this),1e3),this.data("ttStartTime",n.now()),this.data("intervalId",i))},stop:function(){var n=this.data();return n.intervalId&&(clearTimeout(n.intervalId),this.data("intervalId",null)),n},reset:function(t){var r=u.stop.call(this),i=typeof t=="undefined"?r.seconds:t;n(this).data("time-to")&&(i=n(this).data("time-to"));this.find("div").css({backgroundPosition:"left center"});this.find("ul").parent().removeClass("timeTo-alert");e.call(this,i,!0)}},o={en:{days:"days",hours:"hours",min:"minutes",sec:"seconds"},ru:{days:"дней",hours:"часов",min:"минут",sec:"секунд"},ua:{days:"днiв",hours:"годин",min:"хвилин",sec:"секунд"},de:{days:"Tag",hours:"Uhr",min:"Minuten",sec:"Secunden"},fr:{days:"jours",hours:"heures",min:"minutes",sec:"secondes"},es:{days:"días",hours:"horas",min:"minutos",sec:"segundos"},sp:{days:"días",hours:"horas",min:"minutos",sec:"segundos"},it:{days:"giorni",hours:"ore",min:"minuti",sec:"secondi"},nl:{days:"dagen",hours:"uren",min:"minuten",sec:"seconden"},no:{days:"dager",hours:"timer",min:"minutter",sec:"sekunder"},pt:{days:"dias",hours:"horas",min:"minutos",sec:"segundos"},tr:{days:"gün",hours:"saat",min:"dakika",sec:"saniye"},pl:{days:"dni",hours:"godziny",min:"minuty",sec:"secundy"}};return typeof n.support.transition=="undefined"&&(n.support.transition=function(){var t=document.body||document.documentElement,n=t.style;return n.transition!==undefined||n.WebkitTransition!==undefined||n.MozTransition!==undefined||n.MsTransition!==undefined||n.OTransition!==undefined}()),n.fn.timeTo=function(){for(var r={},a=Date.now(),h,v,l,s,y,p,w,b,k,c=0;c<arguments.length;c+=1)h=arguments[c],c===0&&typeof h=="string"?l=h:typeof h=="object"?typeof h.getTime=="function"?r.timeTo=h:r=n.extend(r,h):typeof h=="function"?r.callback=h:(v=parseInt(h,10),isNaN(v)||(r.seconds=v));if(r.timeTo)r.timeTo.getTime?s=r.timeTo.getTime():typeof r.timeTo=="number"&&(s=r.timeTo),r.seconds=s>a?Math.floor((s-a)/1e3):0;else if(r.time||!r.seconds)if(s=r.time,s||(s=new Date(a)),typeof s=="object"&&s.getTime)r.seconds=s.getDate()*t+s.getHours()*f+s.getMinutes()*60+s.getSeconds(),r.countdown=!1;else if(typeof s=="string"){for(p=s.split(":"),w=0,b=1;p.length;)k=p.pop(),w+=k*b,b*=60;r.seconds=w;r.countdown=!1}return r.countdown!==!1&&r.seconds>t&&typeof r.displayDays=="undefined"?(y=Math.floor(r.seconds/t),r.displayDays=y<10&&1||y<100&&2||3):r.displayDays===!0?r.displayDays=3:r.displayDays&&(r.displayDays=r.displayDays>0?Math.floor(r.displayDays):3),this.each(function(){var s=n(this),t=s.data(),et,g,f,nt,h,ot,tt,it,rt,y,c,p,w,ut,b,k,a,v,d,ft,st,ht;if(t.intervalId&&(clearInterval(t.intervalId),t.intervalId=null),t.vals)l!=="reset"&&n.extend(t,r);else{if(g=t.opt?t.options:r,et=Object.keys(i).reduce(function(n,t){return n[t]=Array.isArray(i[t])?i[t].slice(0):i[t],n},{}),t=n.extend(et,g),t.options=g,t.height=Math.round(t.fontSize*100/93)||t.height,t.width=Math.round(t.fontSize*.8+t.height*.13)||t.width,t.displayHours=!!(t.displayDays||t.displayHours),nt={fontFamily:""},t.fontSize>0&&(nt.fontSize=t.fontSize+"px"),h=t.languages[t.lang]||o[t.lang],s.addClass("timeTo").addClass("timeTo-"+t.theme).css(nt),ot=Math.round(t.height/10),tt='<ul style="left:'+ot+"px; top:-"+t.height+'px"><li>0<\/li><li>0<\/li><\/ul><\/div>',it=t.fontSize?' style="width:'+t.width+"px; height:"+t.height+'px;"':' style=""',rt='<div class="first"'+it+">"+tt,y="<div"+it+">"+tt,c="<span>:<\/span>",p=Math.round(t.width*2+3),w=t.captionSize||t.fontSize&&Math.round(t.fontSize*.43),ut=w?"font-size:"+w+"px;":"",b=w?' style="'+ut+'"':"",k=(t.displayCaptions?(t.displayHours?'<figure style="max-width:'+p+'px">$1<figcaption'+b+">"+h.hours+"<\/figcaption><\/figure>"+c:"")+'<figure style="max-width:'+p+'px">$1<figcaption'+b+">"+h.min+"<\/figcaption><\/figure>"+c+'<figure style="max-width:'+p+'px">$1<figcaption'+b+">"+h.sec+"<\/figcaption><\/figure>":(t.displayHours?"$1"+c:"")+"$1"+c+"$1").replace(/\$1/g,rt+y),t.displayDays>0){for(a=Math.round(t.fontSize*.4||i.gap),v=rt,f=t.displayDays-1;f>0;f-=1)v+=f===1?y.replace('">',"margin-right:"+a+'px">'):y;t.displayDays===1&&(v=v.replace('">',"margin-right:"+a+'px">'));k=(t.displayCaptions?'<figure style="width:'+(t.width*t.displayDays+a+4)+'px">$1<figcaption style="'+ut+"padding-right:"+a+'px">'+h.days+"<\/figcaption><\/figure>":"$1").replace(/\$1/,v)+k}s.html(k)}if(d=s.find("div"),d.length<t.vals.length){for(ft=t.vals.length-d.length,st=t.vals,ht=t.limits,t.vals=[],t.limits=[],f=0;f<d.length;f+=1)t.vals[f]=st[ft+f],t.limits[f]=ht[ft+f];t.iSec=t.vals.length-1;t.iHour=t.vals.length-5}t.sec=t.seconds;s.data(t);l&&u[l]?u[l].call(s,t.seconds):t.start?u.start.call(s,t.seconds):e.call(s,t.seconds)})},n});